{"app":{"version":{"available":"1.0.1.201915061500#1","time":null,"linkUpdate":"https://play.google.com/store/apps/details?id=com.ttx.canrealestate","requireUpdate":false,"app_note":"","message_note":"A new version of the application is available. Please update application! # A new version of the application is available and is required to continue. Please update application!","message":"A new version of the application is available. Please update application!"},"getListRealEstate":"function getListRealEstate(filter, cb, cheerio) {\r\n\r\n    //https://www.realestate.com.au/international/ca/rent/?minprice=24900&maxprice=27900&searchtypes=townhouse+apartment\r\n    filter = filter || {};\r\n\r\n    var link = 'https://www.realestate.com.au/international/ca';\r\n\r\n\r\n    var region = filter.region || {};\r\n    var typeBDS = filter.typeBDS || {};\r\n    var khoanggia = filter.khoanggia || {};\r\n    var bedroom = filter.bedroom || {};\r\n    var bathroom = filter.bathroom || {};\r\n    var exchangeRate = function(src) {\r\n        return 1.0813 * src;\r\n    };\r\n\r\n    try {\r\n        exchangeRate = IOUtils.exchangeRate || exchangeRate;\r\n    } catch (error) {}\r\n\r\n    if (region.value && region.value != '-1') {\r\n        link += '/' + region.value;\r\n    }\r\n\r\n    if (!filter.isSellOrBuy) {\r\n        link += '/rent';\r\n    }\r\n\r\n    if (filter.page > 0) {\r\n        link += '/p' + filter.page;\r\n    }\r\n    link += '/?'\r\n    if (typeBDS.value && typeBDS.value !== 'all' && typeBDS.value !== 'any' && typeBDS.value != '-1') {\r\n        link += '&searchtypes=' + typeBDS.value;\r\n    }\r\n\r\n    khoanggia = (khoanggia.value || {}).value || {};\r\n    if (khoanggia.from > 0) {\r\n        link += '&minprice=' + exchangeRate(khoanggia.from);\r\n    }\r\n\r\n    if (khoanggia.to > 0) {\r\n        link += '&maxprice=' + exchangeRate(khoanggia.to);\r\n    }\r\n\r\n    if (bedroom.value && bedroom.value !== 'all' && bedroom.value !== 'any' && bedroom.value != '-1') {\r\n        link += '&numbeds=' + bedroom.value;\r\n    }\r\n\r\n    if (bathroom.value && bathroom.value !== 'all' && bathroom.value !== 'any' && bathroom.value != '-1') {\r\n        link += '&numbaths=' + bathroom.value;\r\n    }\r\n    var sort = 'date+desc';\r\n    if (filter.sort === 'high_price') sort = 'price+desc';\r\n    if (filter.sort === 'low_price') sort = 'price+asc';\r\n    link += '&sort=' + sort;\r\n    IOUtils.log('INFO: getListRealEstate', {\r\n        msg: link\r\n    });\r\n\r\n    fetch(link, {\r\n            headers: new Headers({\r\n                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.157 Safari/537.36',\r\n            })\r\n        })\r\n        .then(function(rp) {\r\n            return rp.text()\r\n        })\r\n        .then(function(text) {\r\n\r\n            //https://www.npmjs.com/package/react-native-cheerio\r\n            var pageItems = [];\r\n\r\n            if (cheerio) {\r\n                $ = cheerio.load(text);\r\n            }\r\n\r\n            var regions = {};\r\n            try {\r\n                var regionList = IOUtils.state.remotes.app.regions;\r\n                regionList.forEach(function(it) {\r\n                    regions[it.code] = true;\r\n                })\r\n            } catch (error) {}\r\n\r\n            var its = $('.listing');\r\n            for (var i = 0; i < its.length; i++) {\r\n\r\n                try {\r\n                    var e = its[i];\r\n                    var p = {};\r\n                    p.id = 'www.realestate.com.au_' + $(e).attr('data-listing-id');\r\n\r\n                    try {\r\n                        p.imgUrl = 'https:' + $(e).find('.picture-zone img').attr('src').replace(/(\\n *\\r{0,})/g, '').trim();\r\n                        p.imgTotal = $(e).find('.pic-total span').html().replace(/(\\n *\\r{0,})/g, '').trim();\r\n                    } catch (error) {\r\n                        continue;\r\n                    }\r\n\r\n                    p.priceAUD = $(e).find('.basic-info .exchanged-price.specified').attr('title').replace(/(\\n *\\r{0,})/g, '').trim();\r\n                    p.priceUSD = $(e).find('.basic-info .listing-price.specified').attr('title').trim();\r\n                    p.priceNum = p.priceUSD.replace(/[^0-9\\.]/g, '');\r\n                    p.price = p.priceUSD;\r\n                    p.typeProduct = $(e).find(' .basic-info .propertytype').html().replace(/(\\n *\\r{0,})/g, '').trim();\r\n                    try {\r\n                        p.size = $(e).find('.basic-info .land-size .num strong').html().trim();\r\n                        if (p.size) {\r\n                            p.size_string = p.size + '(m2)'\r\n                        };\r\n                    } catch (error) {}\r\n\r\n                    p.address = $(e).find('.basic-info .address').text().replace(/(\\n *\\r{0,}\\n)/g, '').trim();\r\n                    p.link = 'https://www.realestate.com.au' + $(e).find('.basic-info .detail-link-box a').attr('href').trim();\r\n                    try {\r\n                        var arr = p.link.match(/([a-z0-9]+)-([a-z0-9]+)-([a-z0-9]+)-([0-9]{5,})/g)[0].split('-');\r\n                        if (regions[arr[0] + '-' + arr[1] + '-' + arr[2]]) {\r\n                            p.regionId = arr[0] + '-' + arr[1] + '-' + arr[2]\r\n                        } else if (regions[arr[1] + '-' + arr[2]]) {\r\n                            p.regionId = arr[1] + '-' + arr[2]\r\n                        } else if (regions[arr[2]]) {\r\n                            p.regionId = arr[2]\r\n                        }\r\n                    } catch (error) {}\r\n                    p.isSellOrBuy = !!filter.isSellOrBuy;\r\n                    pageItems.push(p);\r\n                } catch (error) {\r\n                    console.info(error);\r\n                }\r\n\r\n            }\r\n            cb && cb(true, pageItems);\r\n        })\r\n        .catch(function(error) {\r\n            console.info(error);\r\n            cb && cb(false, []);\r\n        })\r\n}","getDetailRealEstate":"function getDetailRealEstate(filter, cb, cheerio) {\r\n\r\n    filter = filter || {};console.info(\"filter.regionId: \" + filter.regionId);\r\n    var link = filter.link;\r\n    IOUtils.log('INFO: getDetailRealEstate', {msg: link});\r\n    fetch(link, {\r\n            headers: new Headers({\r\n                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.157 Safari/537.36',\r\n            })\r\n        })\r\n        .then(function (rp) {return rp.text()})\r\n        .then(function (text) {\r\n            //https://stackoverflow.com/questions/38343951/how-do-i-parse-an-html-file-in-react-native\r\n\t\t\t\r\n\t    if (cheerio) {\r\n                $ = cheerio.load(text);\r\n            }\r\n            var detail = {\r\n                basicInfo: {},\r\n                imgs: []\r\n            };\r\n\r\n            var imgEs = $('.listing-photo');\r\n\r\n            for (var i = 0; i < imgEs.length; i++) {\r\n                var imgE = imgEs[i];\r\n                var imgLink = $(imgE).find('img').attr('src');\r\n                if (imgLink) {\r\n                    imgLink = 'https:' + imgLink.replace(/global\\/img\\/[0-9]+x[0-9]+-resize/g, 'global/img/688x501-resize');\r\n                    detail.imgs.push(imgLink);\r\n                }\r\n            }\r\n\r\n            detail.originDescription = $('#originDescription').text().trim();\r\n\r\n\t    if (detail.originDescription ) {\r\n                detail.originDescription = \r\n                detail.originDescription\r\n                .replace(/\\n\\s+Direction/g, '\\n\\n\\nDirection')\r\n            }\r\n            detail.phone = $($('.phone')[0]).text().trim();\r\n            detail.agentName = $('.agent-name').text().trim();\r\n            detail.price = filter.price;\r\n            detail.priceNum = filter.priceNum;\r\n\t    detail.price_string = $('.listing-price.specified').attr('title');\r\n\t    detail.address = $($('address strong')[0]).text();\r\n\r\n            detail.basicInfo.yearBuilt = {\r\n                name: 'Year Built',\r\n                value: $('.year-built span').text().trim()\r\n            };\r\n            detail.basicInfo.landSize = {\r\n                name: 'Land Size',\r\n                value: $('.land-size span').text().replace(/\\n */g, '').trim()\r\n            };\r\n            detail.basicInfo.buildingSize = {\r\n                name: 'House Size',\r\n                value: $('.building-size span').text().replace(/\\n */g, '').trim()\r\n            };\r\n            detail.basicInfo.rooms = {\r\n                name: 'Rooms',\r\n                value: \r\n\t\t$('.rooms .value').text().replace(/(\\n *)+/g, ', ').trim()\r\n\t\t.replace(/^ *, */g, '').replace(/ *, *$/g, '')\r\n\t\t.replace(/ +/g, ' ').replace(/, /g, ',\\n')\r\n            };\r\n            detail.basicInfo.architectureStyle = {\r\n                name: 'Architecture Style',\r\n                value: $('.architecture-style .value').text().trim()\r\n            };\r\n            detail.basicInfo.county = {\r\n                name: 'County',\r\n                value: $('.county .value').text().trim()\r\n            };\r\n            detail.basicInfo.subdivision = {\r\n                name: 'Subdivision',\r\n                value: $('.subdivision .value').text().trim()\r\n            };\r\n            detail.basicInfo.address = {\r\n                name: 'Address',\r\n                value: $('.address .value').text().trim()\r\n            };\r\n\t    detail.regionId = filter.regionId;\r\n\t    detail.link = filter.link;\r\n\t    detail.typeProduct = filter.typeProduct;\r\n\t    detail.isSellOrBuy = !!filter.isSellOrBuy;\r\n\t    detail.id = filter.id;\t\r\n            cb && cb(true, detail);\r\n\r\n        })\r\n        .catch(function (error) {\r\n            console.info(error);\r\n            cb && cb(false, {});\r\n        })\r\n}","getRegion":"function getRegion(filter, cb, cheerio) {\r\n\r\n\r\n    try {\r\n        var regions = IOUtils.state.remotes.app.regions;\r\n        if (regions && regions.length) {\r\n            cb && cb(true, regions);\r\n            return;\r\n        }\r\n    } catch (error) {}\r\n\r\n    filter = filter || {};\r\n    var link = 'https://www.realestate.com.au/international/ca/';\r\n\r\n\r\n    try {\r\n        fetch('https://finance-services.msn.com/Market.svc/ChartDataV5?symbols=245.20.CADAUDLITE&chartType=1y&prime=true', {\r\n                headers: new Headers({\r\n                    'Origin': 'https://www.msn.com',\r\n                    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.157 Safari/537.36',\r\n                    'Referer': 'https://www.msn.com/en-us/money/tools/currencyconverter'\r\n                })\r\n            })\r\n            .then(function(rp) {\r\n                return rp.json()\r\n            })\r\n            .then(function(rp) {\r\n\r\n                try {\r\n                    var rate = Number(rp[0].Ycp);\r\n                    if (rate > 0) {\r\n\r\n                        IOUtils.rate = rate;\r\n                        IOUtils.exchangeRate = function(src) {\r\n                            return IOUtils.rate * src;\r\n                        };\r\n                    }\r\n\r\n                } catch (error) {}\r\n            })\r\n            .catch(function(error) {\r\n\r\n            })\r\n    } catch (error) {}\r\n\r\n\r\n    fetch(link, {\r\n            headers: new Headers({\r\n                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.157 Safari/537.36',\r\n            })\r\n        })\r\n        .then(function(rp) {\r\n            return rp.text()\r\n        })\r\n        .then(function(text) {\r\n\r\n            //https://www.npmjs.com/package/react-native-cheerio\r\n            var regions = [];\r\n\r\n            if (cheerio) {\r\n                $ = cheerio.load(text);\r\n            }\r\n\r\n            var props = $('.links-content .content-item');\r\n\r\n            for (var i = 0; i < props.length; i++) {\r\n\r\n                var href = $(props[i]).find('a').attr('href');\r\n                var code = '';\r\n                if (/\\/international\\/ca\\/([a-z0-9\\-]+)\\/{0,1}/g.test(href)) {\r\n                    var rg = {\r\n                        code: href.replace(/\\/international\\/ca\\/([a-z0-9\\-]+)\\/{0,1}/g, '$1'),\r\n                        label: $(props[i]).find('a').text().replace(/(\\n)|(Properties)/g, '').trim()\r\n                    }\r\n                    if (rg.label === 'Washington, D.C.') rg.order = 1;\r\n                    if (rg.label === 'New York') rg.order = 2;\r\n                    if (rg.label === 'Los Angeles') rg.order = 3;\r\n                    if (rg.label === 'San Francisco') rg.order = 4;\r\n                    if (rg.label === 'Seattle') rg.order = 5;\r\n                    if (rg.label === 'Orlando') rg.order = 6;\r\n                    if (rg.label === 'Boston') rg.order = 7;\r\n                    if (rg.label === 'San Diego') rg.order = 8;\r\n                    if (rg.label === 'Chicago') rg.order = 9;\r\n                    regions.push(rg);\r\n                }\r\n\r\n            }\r\n\r\n            try {\r\n\r\n                var typeProducts = [];\r\n                var props = $('.search-property-type');\r\n\r\n                for (var i = 0; i < props.length; i++) {\r\n\r\n                    var code = $(props[i]).find('label').attr('for');\r\n                    if (code) {\r\n                        var rg = {\r\n                            code: code,\r\n                            label: $(props[i]).find('label').text()\r\n                        };\r\n                        typeProducts.push(rg);\r\n                    }\r\n\r\n                }\r\n                IOUtils.state.remotes.app.typeProducts = typeProducts;\r\n            } catch (error) {}\r\n\r\n            try {\r\n                IOUtils.state.remotes.app.regions = regions;\r\n            } catch (error) {}\r\n\r\n            cb && cb(true, regions);\r\n\r\n        })\r\n        .catch(function(error) {\r\n            console.info(error);\r\n            cb && cb(false, []);\r\n        })\r\n}","getTypeProduct":"function getTypeProduct(filter, cb, cheerio) {\r\n\r\n    try {\r\n\r\n        if (IOUtils.state.remotes.app.typeProducts) {\r\n            cb && cb(true, IOUtils.state.remotes.app.typeProducts);\r\n            return;\r\n        }\r\n\r\n    } catch (error) {}\r\n\r\n\r\n    filter = filter || {};\r\n    var link = 'https://www.realestate.com.au/international/ca/';\r\n\r\n    fetch(link)\r\n        .then(function(rp) {\r\n            return rp.text()\r\n        })\r\n        .then(function(text) {\r\n\r\n            //https://www.npmjs.com/package/react-native-cheerio\r\n            var typeProducts = [];\r\n\r\n            if (cheerio) {\r\n                $ = cheerio.load(text);\r\n            }\r\n\r\n            var props = $('.search-property-type');\r\n\r\n            for (var i = 0; i < props.length; i++) {\r\n\r\n                var code = $(props[i]).find('label').attr('for');\r\n                if (code) {\r\n                    typeProducts.push({\r\n                        code: code,\r\n                        label: $(props[i]).find('label').text()\r\n                    });\r\n                }\r\n\r\n            }\r\n            cb && cb(true, typeProducts);\r\n\r\n        })\r\n        .catch(function(error) {\r\n            console.info(error);\r\n            cb && cb(false, []);\r\n        })\r\n}","getBedroom":"function getBedroom(filter, cb, cheerio) {\r\n\r\n\tvar bedrooms = [\r\n\t\t{code: 'any', label: 'Any'},\r\n\t\t{code: '1', label: '1+'},\r\n\t\t{code: '2', label: '2+'},\r\n\t\t{code: '3', label: '3+'},\r\n\t\t{code: '4', label: '4+'},\r\n\t\t{code: '5', label: '5+'}\r\n\t];\r\n\tcb && cb(true, bedrooms);\r\n}","getBathroom":"function getBathroom(filter, cb, cheerio) {\r\n\r\n\tvar bathrooms = [\r\n\t\t{code: 'any', label: 'Any'},\r\n\t\t{code: '1', label: '1+'},\r\n\t\t{code: '2', label: '2+'},\r\n\t\t{code: '3', label: '3+'},\r\n\t\t{code: '4', label: '4+'},\r\n\t\t{code: '5', label: '5+'}\r\n\t];\r\n\tcb && cb(true, bathrooms);\r\n}","getStoredListRealEstate":"function getStoredListRealEstate(filter, cb, cheerio) {\r\n\r\n    filter = filter || {};\r\n\r\n    var region = filter.region || {};\r\n    var typeBDS = filter.typeBDS || {};\r\n    var khoanggia = filter.khoanggia || {};\r\n    var bedroom = filter.bedroom || {};\r\n    var bathroom = filter.bathroom || {};\r\n    var isSellOrBuy = filter.isSellOrBuy === false ? false : true;\r\n\r\n    var regionId = region.id;\r\n    var minPrice = Number(((khoanggia.value || {}).value || {}).from);\r\n    var maxPrice = Number(((khoanggia.value || {}).value || {}).to);\r\n    var items = [];\r\n    var v = {};\r\n    try {\r\n        v = IOUtils.state.stored;\r\n    } catch (error) {\r\n        v = {};\r\n    }\r\n\r\n    v.listId = v.listId || [];\r\n    v.mapId = v.mapId || {};\r\n\r\n    for (var i = 0; i < v.listId.length; i++) {\r\n        try {\r\n            var itemId = v.listId[i];\r\n            var item = v.mapId[itemId];\r\n            if (item) {\r\n                if (isSellOrBuy !== null && isSellOrBuy !== undefined && item.isSellOrBuy !== isSellOrBuy) {\r\n                    console.info(\"false isSellOrBuy\");\r\n                    continue;\r\n                }\r\n                if (regionId && regionId != -1 && item.regionId != regionId) {\r\n                    console.info(\"false regionId\");\r\n                    continue;\r\n                }\r\n                if (minPrice && minPrice > 0 && item['priceNum'] < minPrice) {\r\n                    console.info(\"false min\");\r\n                    continue;\r\n                }\r\n                if (maxPrice && maxPrice > 0 && item['priceNum'] > maxPrice) {\r\n                    console.info(\"false max\");\r\n                    continue;\r\n                }\r\n                if (typeBDS.label !== 'All' && typeBDS.label && item['typeProduct'] !== typeBDS.label) {\r\n                    console.info(\"false typeProduct\");\r\n                    continue;\r\n                }\r\n                if (!item.stored) {\r\n                    v.listId.splice(index, 1);\r\n                    continue;\r\n                }\r\n                items.push(item);\r\n            }\r\n        } catch (error) {\r\n            console.info(error)\r\n        };\r\n    }\r\n    cb && cb(true, items);\r\n    return items;\r\n}"},"ads":[],"dm_may_thang_cho":"dm","disCts":["VN"],"ip":"2402:800:6371:5fde:1c3:a15c:9a25:c81d"}